<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/math/bst.js - JSXGraph</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="../assets/js/jsxgraphcore.js"></script>
    <link rel="stylesheet" href="../assets/css/jsxgraph.css">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo_blue.png" title="JSXGraph" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.99.4</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Angle.html">Angle</a> </li>
                                <li><a href="../classes/Arc.html">Arc</a> </li>
                                <li><a href="../classes/Arrow.html">Arrow</a> </li>
                                <li><a href="../classes/Arrowparallel.html">Arrowparallel</a> </li>
                                <li><a href="../classes/Axis.html">Axis</a> </li>
                                <li><a href="../classes/Bisector.html">Bisector</a> </li>
                                <li><a href="../classes/Bisectorlines.html">Bisectorlines</a> </li>
                                <li><a href="../classes/Button.html">Button</a> </li>
                                <li><a href="../classes/Checkbox.html">Checkbox</a> </li>
                                <li><a href="../classes/Circle.html">Circle</a> </li>
                                <li><a href="../classes/Circumcenter.html">Circumcenter</a> </li>
                                <li><a href="../classes/Circumcircle.html">Circumcircle</a> </li>
                                <li><a href="../classes/CircumcircleArc.html">CircumcircleArc</a> </li>
                                <li><a href="../classes/CircumcircleSector.html">CircumcircleSector</a> </li>
                                <li><a href="../classes/Conic.html">Conic</a> </li>
                                <li><a href="../classes/Curve.html">Curve</a> </li>
                                <li><a href="../classes/Ellipse.html">Ellipse</a> </li>
                                <li><a href="../classes/EventEmitter.html">EventEmitter</a> </li>
                                <li><a href="../classes/Functiongraph.html">Functiongraph</a> </li>
                                <li><a href="../classes/Glider.html">Glider</a> </li>
                                <li><a href="../classes/Grid.html">Grid</a> </li>
                                <li><a href="../classes/Group.html">Group</a> </li>
                                <li><a href="../classes/Hatch.html">Hatch</a> </li>
                                <li><a href="../classes/Hyperbola.html">Hyperbola</a> </li>
                                <li><a href="../classes/Image.html">Image</a> </li>
                                <li><a href="../classes/Incenter.html">Incenter</a> </li>
                                <li><a href="../classes/Incircle.html">Incircle</a> </li>
                                <li><a href="../classes/Inequality.html">Inequality</a> </li>
                                <li><a href="../classes/Input.html">Input</a> </li>
                                <li><a href="../classes/Integral.html">Integral</a> </li>
                                <li><a href="../classes/Intersection.html">Intersection</a> </li>
                                <li><a href="../classes/JXG.html">JXG</a> </li>
                                <li><a href="../classes/JXG.AbstractRenderer.html">JXG.AbstractRenderer</a> </li>
                                <li><a href="../classes/JXG.Board.html">JXG.Board</a> </li>
                                <li><a href="../classes/JXG.C.html">JXG.C</a> </li>
                                <li><a href="../classes/JXG.CanvasRenderer.html">JXG.CanvasRenderer</a> </li>
                                <li><a href="../classes/JXG.Chart.html">JXG.Chart</a> </li>
                                <li><a href="../classes/JXG.Circle.html">JXG.Circle</a> </li>
                                <li><a href="../classes/JXG.Complex.html">JXG.Complex</a> </li>
                                <li><a href="../classes/JXG.Composition.html">JXG.Composition</a> </li>
                                <li><a href="../classes/JXG.Coords.html">JXG.Coords</a> </li>
                                <li><a href="../classes/JXG.CoordsElement.html">JXG.CoordsElement</a> </li>
                                <li><a href="../classes/JXG.Curve.html">JXG.Curve</a> </li>
                                <li><a href="../classes/JXG.GeometryElement.html">JXG.GeometryElement</a> </li>
                                <li><a href="../classes/JXG.Group.html">JXG.Group</a> </li>
                                <li><a href="../classes/JXG.Image.html">JXG.Image</a> </li>
                                <li><a href="../classes/JXG.JSXGraph.html">JXG.JSXGraph</a> </li>
                                <li><a href="../classes/JXG.Line.html">JXG.Line</a> </li>
                                <li><a href="../classes/JXG.Math.html">JXG.Math</a> </li>
                                <li><a href="../classes/JXG.Math.Geometry.html">JXG.Math.Geometry</a> </li>
                                <li><a href="../classes/JXG.Math.Numerics.html">JXG.Math.Numerics</a> </li>
                                <li><a href="../classes/JXG.Math.Poly.html">JXG.Math.Poly</a> </li>
                                <li><a href="../classes/JXG.Math.Poly.Monomial.html">JXG.Math.Poly.Monomial</a> </li>
                                <li><a href="../classes/JXG.Math.Poly.Polynomial.html">JXG.Math.Poly.Polynomial</a> </li>
                                <li><a href="../classes/JXG.Math.Poly.Ring.html">JXG.Math.Poly.Ring</a> </li>
                                <li><a href="../classes/JXG.Math.Quadtree.html">JXG.Math.Quadtree</a> </li>
                                <li><a href="../classes/JXG.Math.Statistics.html">JXG.Math.Statistics</a> </li>
                                <li><a href="../classes/JXG.Math.Symbolic.html">JXG.Math.Symbolic</a> </li>
                                <li><a href="../classes/JXG.NoRenderer.html">JXG.NoRenderer</a> </li>
                                <li><a href="../classes/JXG.Options.html">JXG.Options</a> </li>
                                <li><a href="../classes/JXG.Point.html">JXG.Point</a> </li>
                                <li><a href="../classes/JXG.Polygon.html">JXG.Polygon</a> </li>
                                <li><a href="../classes/JXG.SVGRenderer.html">JXG.SVGRenderer</a> </li>
                                <li><a href="../classes/JXG.Text.html">JXG.Text</a> </li>
                                <li><a href="../classes/JXG.Ticks.html">JXG.Ticks</a> </li>
                                <li><a href="../classes/JXG.Transformation.html">JXG.Transformation</a> </li>
                                <li><a href="../classes/JXG.Turtle.html">JXG.Turtle</a> </li>
                                <li><a href="../classes/JXG.Util.Base64.html">JXG.Util.Base64</a> </li>
                                <li><a href="../classes/JXG.Util.Unzip.html">JXG.Util.Unzip</a> </li>
                                <li><a href="../classes/JXG.VMLRenderer.html">JXG.VMLRenderer</a> </li>
                                <li><a href="../classes/Line.html">Line</a> </li>
                                <li><a href="../classes/Locus.html">Locus</a> </li>
                                <li><a href="../classes/MajorArc.html">MajorArc</a> </li>
                                <li><a href="../classes/Midpoint.html">Midpoint</a> </li>
                                <li><a href="../classes/MinorArc.html">MinorArc</a> </li>
                                <li><a href="../classes/MinorSector.html">MinorSector</a> </li>
                                <li><a href="../classes/Mirrorpoint.html">Mirrorpoint</a> </li>
                                <li><a href="../classes/NonReflexAngle.html">NonReflexAngle</a> </li>
                                <li><a href="../classes/Normal.html">Normal</a> </li>
                                <li><a href="../classes/Orthogonalprojection.html">Orthogonalprojection</a> </li>
                                <li><a href="../classes/OtherIntersection.html">OtherIntersection</a> </li>
                                <li><a href="../classes/Parabola.html">Parabola</a> </li>
                                <li><a href="../classes/Parallel.html">Parallel</a> </li>
                                <li><a href="../classes/Parallelpoint.html">Parallelpoint</a> </li>
                                <li><a href="../classes/Perpendicular.html">Perpendicular</a> </li>
                                <li><a href="../classes/PerpendicularPoint.html">PerpendicularPoint</a> </li>
                                <li><a href="../classes/PerpendicularSegment.html">PerpendicularSegment</a> </li>
                                <li><a href="../classes/Point.html">Point</a> </li>
                                <li><a href="../classes/PolarLine.html">PolarLine</a> </li>
                                <li><a href="../classes/PolePoint.html">PolePoint</a> </li>
                                <li><a href="../classes/Polygon.html">Polygon</a> </li>
                                <li><a href="../classes/RadicalAxis.html">RadicalAxis</a> </li>
                                <li><a href="../classes/Reflection.html">Reflection</a> </li>
                                <li><a href="../classes/ReflexAngle.html">ReflexAngle</a> </li>
                                <li><a href="../classes/registerReader.html">registerReader</a> </li>
                                <li><a href="../classes/RegularPolygon.html">RegularPolygon</a> </li>
                                <li><a href="../classes/Riemannsum.html">Riemannsum</a> </li>
                                <li><a href="../classes/Sector.html">Sector</a> </li>
                                <li><a href="../classes/Segment.html">Segment</a> </li>
                                <li><a href="../classes/Semicircle.html">Semicircle</a> </li>
                                <li><a href="../classes/Slider.html">Slider</a> </li>
                                <li><a href="../classes/Slopetriangle.html">Slopetriangle</a> </li>
                                <li><a href="../classes/Spline.html">Spline</a> </li>
                                <li><a href="../classes/Stepfunction.html">Stepfunction</a> </li>
                                <li><a href="../classes/Tangent.html">Tangent</a> </li>
                                <li><a href="../classes/Tapemeasure.html">Tapemeasure</a> </li>
                                <li><a href="../classes/Text.html">Text</a> </li>
                                <li><a href="../classes/Ticks.html">Ticks</a> </li>
                                <li><a href="../classes/Tracecurve.html">Tracecurve</a> </li>
                                <li><a href="../classes/Transformation.html">Transformation</a> </li>
                                <li><a href="../classes/Turtle.html">Turtle</a> </li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/JXG.html">JXG</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/math/bst.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*
    Copyright 2008-2013
        Matthias Ehmann,
        Michael Gerhaeuser,
        Carsten Miller,
        Bianca Valentin,
        Alfred Wassermann,
        Peter Wilfahrt

    This file is part of JSXGraph.

    JSXGraph is free software dual licensed under the GNU LGPL or MIT License.

    You can redistribute it and/or modify it under the terms of the

      * GNU Lesser General Public License as published by
        the Free Software Foundation, either version 3 of the License, or
        (at your option) any later version
      OR
      * MIT License: https://github.com/jsxgraph/jsxgraph/blob/master/LICENSE.MIT

    JSXGraph is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Lesser General Public License for more details.

    You should have received a copy of the GNU Lesser General Public License and
    the MIT License along with JSXGraph. If not, see &lt;http://www.gnu.org/licenses/&gt;
    and &lt;http://opensource.org/licenses/MIT/&gt;.
 */


/*global JXG:true, define: true*/
/*jslint nomen: true, plusplus: true*/

/* depends:
 math/math
 utils/type
 */

define([&#x27;math/math&#x27;, &#x27;utils/type&#x27;], function (Mat, Type) {

    &quot;use strict&quot;;

    /**
     * Balanced binary search tree
     */
    Mat.BST = function () {
        this.head = null;
        this.z = null;
        this.randomized = true;
    };

    /**
     * public
     */
    Mat.BST.prototype.newNode = function (it, le, ri, n) {
        return {
            item: it,
            l: le,
            r: ri,
            N: n
        };
    };

    Mat.BST.prototype.init = function (random) {
        this.z = this.newNode(null, 0, 0, 0);
        this.head = this.z;

        if (Type.exists(random)) {
            this.randomized = random;
        }
    };

    Mat.BST.prototype.count = function () {
        return this.head.N;
    };

    Mat.BST.prototype.search = function (val) {
        return this.searchR(this.head, val);
    };

    Mat.BST.prototype.insert = function (item) {
        if (this.randomized) {
            this.head = this.insertRandR(this.head, item);
        } else {
            this.head = this.insertR(this.head, item);
        }
    };

    Mat.BST.prototype.traverse = function (h, visit) {
        if (this.isNil(h)) {
            return;
        }
        visit(h);
        this.traverse(h.l, visit);
        this.traverse(h.r, visit);
    };

    Mat.BST.prototype.insertHead = function (item) {
        this.head = this.insertT(this.head, item);
    };

    Mat.BST.prototype.deleteNode = function (v) {
        this.head = this.deleteR(this.head, v);
    };

    Mat.BST.prototype.join = function (a, b) {
        if (this.isNil(b)) {
            return a;
        }

        if (this.isNil(a)) {
            return b;
        }

        b = this.insertT(b, a.item);
        b.l = this.join(a.l, b.l);
        b.r = this.join(a.r, b.r);

        this.fixN(b);

        return b;
    };

    Mat.BST.prototype.select = function (k) {
        return this.selectR(this.head, k);
    };

    Mat.BST.prototype.balance = function () {
        this.head = this.balanceR(this.head);
    };

    Mat.BST.prototype.show = function () {
        this.showR(this.head, 0);
    };

    Mat.BST.prototype.joinRand = function (a, b) {
        if (Math.random() / (1 / (a.N + b.N) + 1) &lt; a.N) {
            return this.joinRandR(a, b);
        }

        return this.joinRandR(b, a);
    };

    Mat.BST.prototype.minimum = function (h) {
        if (this.isNil(h)) {
            return h;
        }

        while (!this.isNil(h.l)) {
            h = h.l;
        }

        return h;
    };

    Mat.BST.prototype.maximum = function (h) {
        if (this.isNil(h)) {
            return h;
        }

        while (!this.isNil(h.r)) {
            h = h.r;
        }

        return h;
    };

    Mat.BST.prototype.next = function (node) {
        var nxt, h = this.head;

        // Trivial case
        if (this.isNil(h)) {
            return h;
        }

        if (!this.isNil(node.r)) {
            return this.minimum(node.r);
        }

        while (!this.isNil(h)) {
            if (node.item &lt; h.item) {
                nxt = h;
                h = h.l;
            } else if (h.item &lt; node.item) {
                h = h.r;
            } else {
                break;
            }
        }

        return nxt;
    };

    Mat.BST.prototype.prev = function (node) {
        var nxt, h = this.head;

        // Trivial case
        if (this.isNil(h)) {
            return h;
        }

        if (!this.isNil(node.l)) {
            return this.maximum(node.l);
        }

        while (!this.isNil(h)) {
            if (node.item &lt; h.item) {
                h = h.l;
            } else if (h.item &lt; node.item) {
                nxt = h;
                h = h.r;
            } else {
                break;
            }
        }

        return nxt;
    };


    /**
     * private
     */
    Mat.BST.prototype.fixN = function (h) {
        h.N = h.l.N + h.r.N + 1;
    };

    Mat.BST.prototype.isNil = function (h) {
        return h.l === 0 &amp;&amp; h.r === 0;
    };

    Mat.BST.prototype.searchR = function (h, val) {
        var t = h.item;
        if (this.isNil(h)) {
            return this.z;
        }

        if (val === t) {
            return h;
        }

        if (val &lt; t) {
            return this.searchR(h.l, val);
        }

        return this.searchR(h.r, val);
    };

    Mat.BST.prototype.insertR = function (h, item) {
        if (this.isNil(h)) {
            return this.newNode(item, this.z, this.z, 1);
        }

        if (item &lt; h.item) {
            h.l = this.insertR(h.l, item);
        } else {
            h.r = this.insertR(h.r, item);
        }

        h.N++;
        return h;
    };

    Mat.BST.prototype.rotR = function (h) {
        var x = h.l;

        h.l = x.r;
        x.r = h;

        this.fixN(h);
        this.fixN(x);

        return x;
    };

    Mat.BST.prototype.rotL = function (h) {
        var x = h.r,
            n = x.N;

        h.r = x.l;
        x.l = h;

        this.fixN(h);
        this.fixN(x);

        return x;
    };

    Mat.BST.prototype.insertT = function (h, item) {
        if (this.isNil(h)) {
            return this.newNode(item, this.z, this.z, 1);
        }

        if (item &lt; h.item) {
            h.l = this.insertT(h.l, item);
            h = this.rotR(h);
        } else {
            h.r = this.insertT(h.r, item);
            h = this.rotL(h);
        }

        return h;
    };

    Mat.BST.prototype.selectR = function (h, k) {
        var t;

        if (this.isNil(h)) {
            return null;
        }

        t = (this.isNil(h.l)) ? 0 : h.l.N;

        if (t &gt; k) {
            return this.selectR(h.l, k);
        }

        if (t &lt; k) {
            return this.selectR(h.r, k - t - 1);
        }

        return h.item;
    };

    Mat.BST.prototype.partR = function (h, k) {
        var t = h.l.N;

        if (t &gt; k) {
            h.l = this.partR(h.l, k);
            h = this.rotR(h);
            this.head = h;
        }

        if (t &lt; k) {
            h.r = this.partR(h.r, k - t - 1);
            h = this.rotL(h);
            this.head = h;
        }

        return h;
    };

    Mat.BST.prototype.joinLR = function (a, b) {
        if (this.isNil(b)) {
            return a;
        }

        b = this.partR(b, 0);
        b.l = a;
        this.fixN(b);
        return b;
    };

    Mat.BST.prototype.deleteR = function (h, v) {
        var x,
            t = h.item;

        if (this.isNil(h)) {
            return this.z;
        }

        if (v &lt; t) {
            h.l = this.deleteR(h.l, v);
        }
        if (t &lt; v) {
            h.r = this.deleteR(h.r, v);
        }

        if (t === v) {
            x = h;

            if (this.randomized) {
                h = this.joinRandLR(h.l, h.r);
            } else {
                h = this.joinLR(h.l, h.r);
            }
        }

        if (this.isNil(h)) {
            this.fixN(h);
        }

        return h;
    };

    Mat.BST.prototype.balanceR = function (h) {
        if (h.N &lt; 2) {
            return h;
        }

        h = this.partR(h, Math.floor(h.N / 2));

        h.l = this.balanceR(h.l);
        h.r = this.balanceR(h.r);

        return h;
    };

    /**
     * Randomized Balnaced Binary Trees
     */
    Mat.BST.prototype.insertRandR = function (h, item) {
        var t = h.item;

        if (this.isNil(h)) {
            return this.newNode(item, this.z, this.z, 1);
        }

        if (Math.random() &lt; 1 / (h.N + 1)) {
            return this.insertT(h, item);
        }

        if (item &lt; t) {
            h.l = this.insertRandR(h.l, item);
        } else {
            h.r = this.insertRandR(h.r, item);
        }
        h.N++;

        return h;
    };

    Mat.BST.prototype.joinRandR = function (a, b) {
        if (this.isNil(a)) {
            return b;
        }

        b = this.insertRandR(b, a.item);
        b.l  = this.joinRand(a.l, b.l);
        b.r  = this.joinRand(a.r, b.r);

        this.fixN(b);

        return b;
    };

    Mat.BST.prototype.joinRandLR = function (a, b) {
        if (this.isNil(a)) { return b; }
        if (this.isNil(b)) { return a; }

        if (Math.random() / (1 / (a.N + b.N) + 1) &lt; a.N) {
            a.r = this.joinRandLR(a.r, b);
            return a;
        }

        b.l = this.joinRandLR(a, b.l);
        return b;
    };

    /**
     * Test output
     */
    Mat.BST.prototype.printnode = function (node, hgt) {
        var i,
            t = &#x27;&#x27;;

        for (i = 0; i &lt; hgt; i++) {
            t += &#x27; &#x27;;
        }
        t += &#x27;(&#x27; + node.item + &#x27;,&#x27; + node.N + &#x27;)&#x27;;
        console.log(t);
    };

    Mat.BST.prototype.showR = function (x, hgt) {
        if (this.isNil(x)) {
            this.printnode(x, hgt);
            return;
        }

        this.showR(x.r, hgt + 1);
        this.printnode(x, hgt);
        this.showR(x.l, hgt + 1);
    };


    /**
     * Heap
     */
    Mat.Heap = function () {
        this.pq = [];
        this.N = 0;
    };

    /**
     * public
     */
    Mat.Heap.prototype.empty = function () {
        this.pq = [];
        this.N = 0;
    };

    Mat.Heap.prototype.insert = function (v) {
        this.pq[this.N] = v;
        this.N++;
        this.fixUp(this.N);
    };

    Mat.Heap.prototype.delmax = function () {
        this.exchange(0, this.N - 1);
        this.fixDown(0, this.N - 1);
        this.N--;

        return this.pq[this.N];
    };

    /**
     * private
     */
    Mat.Heap.prototype.fixUp = function (k) {
        var i = k - 1;

        while (i &gt; 0 &amp;&amp; this.pq[Math.floor(i / 2)] &lt; this.pq[i]) {
            this.exchange(Math.floor(i / 2), i);
            i = Math.floor(i / 2);
        }
    };

    Mat.Heap.prototype.fixDown = function (k, N) {
        var j, i = k;
        while (2 * i &lt; N) {
            j = 2 * i;

            if (j &lt; N &amp;&amp; this.pq[j] &lt; this.pq[j + 1]) {
                j++;
            }

            if (this.pq[i] &gt;= this.pq[j]) {
                break;
            }

            this.exchange(i, j);
            i = j;
        }
    };

    Mat.Heap.prototype.exchange = function (i, j) {
        var t = this.pq[i];
        this.pq[i] = this.pq[j];
        this.pq[j] = t;
    };

    return Mat.BST;
});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
